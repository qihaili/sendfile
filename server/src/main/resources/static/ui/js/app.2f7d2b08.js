(function(e){function t(t){for(var s,l,o=t[0],r=t[1],c=t[2],p=0,u=[];p<o.length;p++)l=o[p],i[l]&&u.push(i[l][0]),i[l]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);d&&d(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,o=1;o<a.length;o++){var r=a[o];0!==i[r]&&(s=!1)}s&&(n.splice(t--,1),e=l(l.s=a[0]))}return e}var s={},i={app:0},n=[];function l(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=s,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(a,s,function(t){return e[t]}.bind(null,s));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/ui/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=r;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var s=a("64a9"),i=a.n(s);i.a},"41f3":function(e,t,a){"use strict";var s=a("bd16"),i=a.n(s);i.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("el-row",[a("i",{staticClass:"el-icon-s-promotion",staticStyle:{"margin-right":"20px","font-size":"60px",color:"#409EFF","vertical-align":"middle"}}),a("span",{staticStyle:{"font-size":"40px","font-weight":"bold",color:"#606266","vertical-align":"middle"}},[e._v("Send File")])]),a("router-view")],1)},n=[],l={name:"app"},o=l,r=(a("034f"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,null,null),d=c.exports,p=a("8c4f"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"mycard",staticStyle:{width:"400px"}},[e.config?e.isChooseUpload?a("div",[a("el-progress",{staticStyle:{"margin-top":"20px"},attrs:{type:"circle","stroke-width":18,percentage:e.uploadPercentage,status:e.uploadStatus}}),a("div",{staticStyle:{height:"20px","line-height":"20px"}},[a("span",{staticStyle:{"font-size":"small"}},[e._v(e._s(e.speed))])]),e.share?a("div",{staticStyle:{"text-align":"left",position:"relative",height:"260px"}},[e.config?a("span",{staticStyle:{"font-size":"small"}},[e._v("文件"),e.share.ttl?a("span",[e._v("将于 "+e._s(this.util.humanreadableDuration(e.share.ttl))+" ")]):a("span",[e._v("永不")]),e._v("过期")]):e._e(),a("div",{staticStyle:{margin:"20px 5px"}},[a("el-row",[e._v("下载链接：")]),a("el-input",{attrs:{value:e.address}},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.address,expression:"address",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"}],attrs:{slot:"append",type:"primary",size:"mini"},slot:"append"},[e._v("复制链接")])],1),a("el-row",{staticStyle:{"font-size":"small"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px"}}),e._v("复制链接地址，粘贴到浏览器地址栏中，并打开页面")])],1),a("div",{staticStyle:{position:"absolute",bottom:"0px","text-align":"center",width:"100%"}},[a("el-link",{attrs:{type:"primary",icon:"el-icon-s-home"},on:{click:e.backToHome}},[e._v("再次上传")])],1)]):a("div",{staticStyle:{margin:"50px 5px"}},[a("span",[e._v("正在上传，成功后生成下载链接。。。")])])],1):a("div",{staticStyle:{"text-align":"left"}},[a("el-upload",{ref:"upload",staticStyle:{"text-align":"left","min-height":"310px"},attrs:{drag:"",action:"","show-file-list":!0,"auto-upload":!1,multiple:!0,"on-change":e.onChange}},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{"font-size":"67px",color:"#C0C4CC",margin:"40px 0 16px","line-height":"50px"}}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击添加文件")])]),e.config?a("div",{staticClass:"el-upload__tip",staticStyle:{"text-align":"center"},attrs:{slot:"tip"},slot:"tip"},[e._v("可上传"),e.config.share.maxFileSize>0?a("span",[e._v(e._s(this.config.share.maxFileSize)+"MB")]):a("span",[e._v("任意大小")]),e._v("的文件")]):e._e()]),a("el-row",{staticStyle:{"margin-top":"10px"}},[e.config?a("el-select",{staticStyle:{width:"100px"},attrs:{disabled:null===e.fileList||0==e.fileList.length,placeholder:"请选择",size:"mini"},model:{value:e.ttl,callback:function(t){e.ttl=t},expression:"ttl"}},e._l(e.config.share.ttlOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})}),1):e._e(),a("span",{staticStyle:{"margin-left":"10px","font-size":"small",color:"#606266"}},[e._v("后过期")])],1),a("el-row",{staticStyle:{"margin-top":"10px","line-height":"28px"}},[a("el-checkbox",{model:{value:e.passwordEnabled,callback:function(t){e.passwordEnabled=t},expression:"passwordEnabled"}},[e._v("密码保护")]),e.passwordEnabled?a("el-input",{staticStyle:{width:"200px","margin-left":"10px"},attrs:{size:"mini"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}):e._e()],1),a("el-button",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{type:"primary",icon:"el-icon-upload",disabled:null===e.fileList||0==e.fileList.length},on:{click:e.submitUpload}},[e._v("上传")])],1):a("div",{staticStyle:{"min-height":"300px",width:"100%",display:"table","text-align":"center"}},[a("p",{staticStyle:{display:"table-cell","vertical-align":"middle",color:"#F56C6C","font-size":"large"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px"}}),e._v(e._s(e.errorMsg))])])]),a("transition",[e.uploadedList.length>0?a("el-card",{staticClass:"mycard",staticStyle:{width:"502px"}},[a("transition-group",{attrs:{name:"list"}},e._l(e.uploadedList,function(t){return a("el-card",{key:t.id,staticStyle:{margin:"10px 0px"}},[a("files",{attrs:{share:t,"on-removed":e.shareRemoved}})],1)}),1)],1):e._e()],1)],1)},h=[],f=(a("6b54"),a("ac4d"),a("8a81"),a("ac6a"),a("bc3a")),g=a.n(f),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.share.files,function(t,s){return a("el-row",{key:s},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-tooltip",{attrs:{content:t.name,placement:"top"}},[a("el-link",{staticStyle:{"vertical-align":"middle","font-size":"large",margin:"0px"},attrs:{href:"/api/shares/"+e.share.id+"/"+t.name,icon:"el-icon-document"}},[a("div",{staticStyle:{"max-width":"340px","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[e._v(e._s(t.name))])])],1)],1),a("div",{staticStyle:{display:"inline-block",float:"right"}},[a("span",{staticStyle:{"vertical-align":"middle","font-size":"small"}},[e._v(e._s(e.humanReadableDataSize(t.size)))])])])}),a("div",{staticClass:"el-divider el-divider--horizontal",staticStyle:{margin:"10px 0px"}}),a("el-row",[a("div",{staticStyle:{display:"inline-block",float:"left","text-align":"left"}},[a("el-row",[a("span",{staticStyle:{"vertical-align":"middle","font-size":"small"}},[e._v("文件"),e.share.ttl?a("span",[e._v("将于 "+e._s(this.util.humanreadableDuration(e.share.ttl))+" ")]):a("span",[e._v("永不")]),e._v("过期")])])],1),a("div",{staticStyle:{display:"inline-block",float:"right"}},[a("el-tooltip",{attrs:{content:"复制链接",placement:"top"}},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.address,expression:"address",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"}],attrs:{size:"mini",icon:"el-icon-document-copy"}})],1),e.share.token?a("el-tooltip",{attrs:{content:"删除文件",placement:"top"}},[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",loading:e.deleteLoading},on:{click:e.deleteShare}})],1):e._e()],1)])],2)},m=[],y=a("5118"),w={props:{share:{type:Object},onRemoved:{type:Function,required:!0}},data:function(){return{address:window.location.href+("/"==this.$route.path?this.share.id:""),syncSharePolling:null,countdown:null,deleteLoading:!1}},created:function(){this.syncShare(),this.syncSharePolling=Object(y["setInterval"])(this.syncShare,12e4)},destroyed:function(){Object(y["clearInterval"])(this.syncSharePolling)},methods:{onCopySuccess:function(){this.$message.success("地址已复制")},syncShare:function(){var e=this;this.countdown&&Object(y["clearInterval"])(this.countdown),g.a.get("/api/shares/".concat(this.share.id),{headers:{token:this.share.token,password:this.share.password}}).then(function(t){e.share.ttl=t.data.ttl,e.share.files=t.data.files,e.share.ttl&&(e.countdown=Object(y["setInterval"])(e.refreshTtl,1e4))}).catch(function(t){404==t.response.status?e.onRemoved(e.share):e.$message.error(t.response.data.message?t.response.data.message:t.toString())})},refreshTtl:function(){this.share.ttl-=1e4},deleteShare:function(){var e=this;this.deleteLoading=!0,this.$confirm("确定删除文件共享？",{type:"warning"}).then(function(){g.a.delete("/api/shares/".concat(e.share.id),{headers:{token:e.share.token}}).then(function(){e.onRemoved(e.share)}).catch(function(t){e.$message.error(t.response.data.message?t.response.data.message:t.toString())}).finally(function(){e.deleteLoading=!1})}).catch(function(){e.deleteLoading=!1})},humanReadableDataSize:function(e){var t;return t=e>1099511627776?(e/1099511627776).toFixed(1)+"TB":e>1073741824?(e/1073741824).toFixed(1)+"GB":e>1048576?(e/1048576).toFixed(1)+"MB":e>1024?(e/1024).toFixed(1)+"KB":e.toFixed(0)+"Bytes",t}}},x=w,S=Object(r["a"])(x,v,m,!1,null,null,null),b=S.exports,_={components:{files:b},data:function(){return{isChooseUpload:!1,share:null,uploadPercentage:0,uploadStatus:null,speed:null,lastLoaded:0,lastLoadTime:null,config:null,ttl:null,uploadedList:null==localStorage.getItem("uploaded")?[]:JSON.parse(localStorage.getItem("uploaded")),fileList:null,passwordEnabled:!1,password:null,errorMsg:null}},computed:{address:function(){return window.location.href+this.share.id}},created:function(){var e=this,t=this.$loading();g.a.get("/api/config").then(function(t){e.config=t.data;var a=!0,s=!1,i=void 0;try{for(var n,l=e.config.share.ttlOptions[Symbol.iterator]();!(a=(n=l.next()).done);a=!0){var o=n.value;o.defaultOption&&(e.ttl=o.value)}}catch(r){s=!0,i=r}finally{try{a||null==l.return||l.return()}finally{if(s)throw i}}e.ttl||(e.ttl=e.config.share.ttlOptions[0].value)}).catch(function(t){e.errorMsg=t.response.data.message?t.response.data.message:t.toString()}).finally(function(){t.close()})},methods:{submitUpload:function(){var e=this,t=new FormData;t.append("ttl",this.ttl),this.passwordEnabled&&this.password&&t.append("password",this.password);var a=!0,s=!1,i=void 0;try{for(var n,l=this.fileList[Symbol.iterator]();!(a=(n=l.next()).done);a=!0){var o=n.value;t.append("file",o.raw)}}catch(r){s=!0,i=r}finally{try{a||null==l.return||l.return()}finally{if(s)throw i}}g.a.post("/api/shares",t,{onUploadProgress:this.showProgress}).then(function(t){e.handleSuccess(t.data)}).catch(function(t){e.handleError(t)}),this.isChooseUpload=!0},onChange:function(e,t){this.fileList=t},handleSuccess:function(e){this.$message.success("上传成功"),this.isSuccess=!0,this.share=e,this.uploadStatus="success",this.speed=null,this.uploadedList.unshift(this.share),this.save()},handleError:function(e){this.$message.error("上传失败。"+e),this.uploadStatus="exception"},showProgress:function(e){this.uploadPercentage=parseInt(100*e.loaded/e.total);var t=(new Date).getTime(),a=(t-this.lastLoadTime)/1e3;if(a>1){var s=e.loaded-this.lastLoaded;this.lastLoaded=e.loaded,this.lastLoadTime=t;var i=s/a;this.speed=i>1073741824?(i/1073741824).toFixed(1)+" GB/s":i>1048576?(i/1048576).toFixed(1)+" MB/s":i>1024?(i/1024).toFixed(1)+" KB/s":i.toFixed(0)+" B/s"}},handleRemove:function(){return!1},chooseUpload:function(e){if(this.maxFileSize>0&&e.size>1024*this.maxFileSize*1024)return this.$message.error("文件过大，不能超过"+this.maxFileSize+"MB"),!1;this.isChooseUpload=!0,this.isChooseDownload=!1,this.lastLoadTime=(new Date).getTime()},onCopySuccess:function(){this.$message.success("地址已复制")},backToHome:function(){this.isChooseUpload=!1,this.uploadStatus=null,this.uploadPercentage=0,this.share=null,this.fileList=null},shareRemoved:function(e){for(var t=-1,a=0;a<this.uploadedList.length;a++){var s=this.uploadedList[a];if(s.id==e.id){t=a;break}}t>-1&&(this.uploadedList.splice(t,1),this.save())},save:function(){var e=JSON.parse(JSON.stringify(this.uploadedList)),t=!0,a=!1,s=void 0;try{for(var i,n=e[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var l=i.value;l.ttl=null}}catch(o){a=!0,s=o}finally{try{t||null==n.return||n.return()}finally{if(a)throw s}}localStorage.setItem("uploaded",JSON.stringify(e))}}},k=_,C=(a("41f3"),Object(r["a"])(k,u,h,!1,null,null,null)),L=C.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticStyle:{width:"560px","min-height":"400px",display:"inline-block",margin:"10px"}},[a("div",{staticStyle:{"min-height":"344px"}},[e.share?a("div",{staticStyle:{"min-height":"310px"}},[a("span",[e._v("文件（点击文件名下载）")]),a("el-divider"),a("files",{staticStyle:{margin:"0px 50px 0px 50px"},attrs:{share:e.share,"on-removed":e.shareRemoved}})],1):e.needPassword?a("div",{staticStyle:{"min-height":"310px"}},[a("el-row",{staticStyle:{height:"70px"}}),a("el-row",[a("span",[e._v("文件已加密，请输入密码")])]),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-input",{staticStyle:{width:"300px","margin-right":"10px"},attrs:{autofocus:"",type:e.showPassword?"text":"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getShare(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}},[a("i",{class:"el-input__icon iconfont "+(e.showPassword?"icon-eye-open":"icon-eye-close"),staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function(t){e.showPassword=!e.showPassword}},slot:"suffix"})]),a("el-button",{attrs:{type:"primary"},on:{click:e.getShare}},[e._v("解锁")])],1)],1):a("div",{staticStyle:{"min-height":"310px",width:"100%",display:"table","text-align":"center"}},[a("p",{staticStyle:{"font-size":"large","vertical-align":"middle",display:"table-cell"}},[e._v(e._s(e.errorMsg))])]),a("div",{staticStyle:{"margin-top":"20px",width:"100%"}},[a("el-link",{attrs:{type:"primary"},on:{click:e.gotoUpload}},[e._v("使用SendFile共享文件")])],1)])])],1)},z=[],P={components:{files:b},data:function(){return{share:null,errorMsg:null,needPassword:!1,password:null,showPassword:!1}},created:function(){this.getShare()},methods:{gotoUpload:function(){this.$router.push("/")},getShare:function(){var e=this,t=this.$loading();g.a.get("/api/shares/".concat(this.$route.params.shareId),{headers:{password:this.password}}).then(function(t){e.share=t.data,e.share.password=e.password}).catch(function(t){401==t.response.status?(e.needPassword=!0,e.password&&e.$message.error("密码错误")):e.errorMsg=t.response.data.message?t.response.data.message:t}).finally(function(){t.close()})},shareRemoved:function(e){this.errorMsg="文件已过期",this.needPassword=!1,this.share=null}}},F=P,$=Object(r["a"])(F,O,z,!1,null,null,null),j=$.exports;s["default"].use(p["a"]);var M=new p["a"]({routes:[{path:"/",component:L},{path:"/:shareId",component:j}]}),E=a("4eb5"),T=a.n(E),I=a("5c96"),B=a.n(I),U=(a("0fae"),{humanreadableDuration:function(e){var t="";return e>864e5&&(t+=parseInt(e/864e5)+"天",e%=864e5),e>36e5&&(t+=parseInt(e/36e5)+"小时",e%=36e5),e>6e4&&(t+=parseInt(e/6e4)+"分钟"),""==t?t="1分钟内":t+="后",t}});a("ed2c");s["default"].config.productionTip=!1,s["default"].use(B.a),s["default"].use(T.a),s["default"].prototype.util=U,new s["default"]({router:M,render:function(e){return e(d)}}).$mount("#app")},"64a9":function(e,t,a){},bd16:function(e,t,a){},ed2c:function(e,t,a){}});
//# sourceMappingURL=app.2f7d2b08.js.map