(function(t){function e(e){for(var i,l,o=e[0],r=e[1],c=e[2],u=0,p=[];u<o.length;u++)l=o[u],s[l]&&p.push(s[l][0]),s[l]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);d&&d(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var r=a[o];0!==s[r]&&(i=!1)}i&&(n.splice(e--,1),t=l(l.s=a[0]))}return t}var i={},s={app:0},n=[];function l(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=t,l.c=i,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(a,i,function(e){return t[e]}.bind(null,i));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/ui/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=r;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var i=a("64a9"),s=a.n(i);s.a},"41f3":function(t,e,a){"use strict";var i=a("bd16"),s=a.n(i);s.a},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t._m(0),a("router-view")],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("span",{staticStyle:{"font-size":"60px","font-weight":"bold",color:"#606266"}},[a("i",{staticClass:"el-icon-s-promotion",staticStyle:{"margin-right":"20px"}}),t._v("SeNDFile")])])}],l={name:"app"},o=l,r=(a("034f"),a("2877")),c=Object(r["a"])(o,s,n,!1,null,null,null),d=c.exports,u=a("8c4f"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"mycard",staticStyle:{width:"400px"}},[t.isChooseUpload?a("div",[a("el-progress",{staticStyle:{"margin-top":"20px"},attrs:{type:"circle","stroke-width":18,percentage:t.uploadPercentage,status:t.uploadStatus}}),a("div",{staticStyle:{height:"20px","line-height":"20px"}},[a("span",{staticStyle:{"font-size":"x-small"}},[t._v(t._s(t.speed))])]),t.share?a("div",{staticStyle:{"text-align":"left"}},[t.config?a("span",{staticStyle:{"font-size":"x-small"}},[t._v("文件"),t.share.ttl?a("span",[t._v("将于 "+t._s(this.util.humanreadableDuration(t.share.ttl))+" ")]):a("span",[t._v("永不")]),t._v("过期")]):t._e(),a("div",{staticStyle:{margin:"20px 5px"}},[a("el-row",[t._v("下载链接：")]),a("el-input",{staticStyle:{"min-width":"350px"},attrs:{value:t.address}},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.address,expression:"address",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopySuccess,expression:"onCopySuccess",arg:"success"}],attrs:{slot:"append",type:"primary",size:"mini"},slot:"append"},[t._v("复制链接")])],1),a("el-row",{staticStyle:{"font-size":"xx-small"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px"}}),t._v("复制链接地址，粘贴到浏览器地址栏中，并打开页面")])],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-link",{attrs:{type:"primary"},on:{click:t.backToHome}},[t._v("再次上传")])],1)]):a("div",{staticStyle:{margin:"50px 5px"}},[a("span",[t._v("正在上传，成功后生成下载链接。。。")])])],1):a("div",{staticStyle:{"text-align":"left"}},[a("el-upload",{ref:"upload",staticStyle:{"text-align":"left","min-height":"310px"},attrs:{drag:"",action:"","show-file-list":!0,"auto-upload":!1,multiple:!0,"on-change":t.onChange}},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{"font-size":"67px",color:"#C0C4CC",margin:"40px 0 16px","line-height":"50px"}}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击添加文件")])]),t.config?a("div",{staticClass:"el-upload__tip",staticStyle:{"text-align":"center"},attrs:{slot:"tip"},slot:"tip"},[t._v("可上传"),t.config.share.maxFileSize>0?a("span",[t._v(t._s(this.config.share.maxFileSize)+"MB")]):a("span",[t._v("任意大小")]),t._v("的文件")]):t._e()]),t.config?a("el-select",{staticStyle:{width:"100px","margin-top":"15px"},attrs:{disabled:null===t.fileList||0==t.fileList.length,placeholder:"请选择",size:"small"},model:{value:t.ttl,callback:function(e){t.ttl=e},expression:"ttl"}},t._l(t.config.share.ttlOptions,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.value}})}),1):t._e(),a("span",{staticStyle:{"margin-left":"10px","font-size":"small",color:"#606266"}},[t._v("后过期")]),a("el-button",{staticStyle:{width:"100%","margin-top":"15px"},attrs:{type:"success",icon:"el-icon-upload",disabled:null===t.fileList||0==t.fileList.length},on:{click:t.submitUpload}},[t._v("上传")])],1)]),a("transition",[t.uploadedList.length>0?a("el-card",{staticClass:"mycard",staticStyle:{width:"440px"}},[a("transition-group",{attrs:{name:"list"}},t._l(t.uploadedList,function(e){return a("el-card",{key:e.id,staticStyle:{margin:"10px 0px"}},[a("files",{attrs:{share:e,"on-removed":t.shareRemoved,deletable:!0}})],1)}),1)],1):t._e()],1)],1)},h=[],f=(a("ac4d"),a("8a81"),a("ac6a"),a("bc3a")),v=a.n(f),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._l(t.share.files,function(e,i){return a("el-row",{key:i},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-tooltip",{attrs:{content:e.name,placement:"top"}},[a("el-link",{staticStyle:{"vertical-align":"middle","font-size":"medium",margin:"0px"},attrs:{href:"/api/shares/"+t.share.id+"/"+e.name,icon:"el-icon-document"}},[a("div",{staticStyle:{"max-width":"280px","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[t._v(t._s(e.name))])])],1)],1),a("div",{staticStyle:{display:"inline-block",float:"right"}},[a("span",{staticStyle:{"vertical-align":"middle","font-size":"x-small"}},[t._v(t._s(t.humanReadableDataSize(e.size)))])])])}),a("div",{staticClass:"el-divider el-divider--horizontal",staticStyle:{margin:"10px 0px"}}),a("el-row",[a("div",{staticStyle:{display:"inline-block",float:"left","text-align":"left"}},[a("el-row",[a("span",{staticStyle:{"vertical-align":"middle","font-size":"xx-small"}},[t._v("文件"),t.share.ttl?a("span",[t._v("将于 "+t._s(this.util.humanreadableDuration(t.share.ttl))+" ")]):a("span",[t._v("永不")]),t._v("过期")])])],1),a("div",{staticStyle:{display:"inline-block",float:"right"}},[a("el-tooltip",{attrs:{content:"复制链接",placement:"top"}},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.address,expression:"address",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopySuccess,expression:"onCopySuccess",arg:"success"}],attrs:{size:"mini",icon:"el-icon-document-copy"}})],1),t.deletable?a("el-tooltip",{attrs:{content:"删除文件",placement:"top"}},[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",loading:t.deleteLoading},on:{click:t.deleteShare}})],1):t._e()],1)])],2)},g=[],y=a("5118"),x={props:{share:{type:Object},deletable:{type:Boolean,default:!1},onRemoved:{type:Function,required:!0}},data:function(){return{address:window.location.href+("/"==this.$route.path?this.share.id:""),syncSharePolling:null,countdown:null,deleteLoading:!1}},created:function(){this.syncShare(),this.syncSharePolling=Object(y["setInterval"])(this.syncShare,12e4)},destroyed:function(){Object(y["clearInterval"])(this.syncSharePolling)},methods:{onCopySuccess:function(){this.$message.success("地址已复制")},syncShare:function(){var t=this;this.countdown&&Object(y["clearInterval"])(this.countdown),v.a.get("/api/shares/".concat(this.share.id)).then(function(e){t.share.ttl=e.data.ttl,t.share.files=e.data.files,t.share.ttl&&(t.countdown=Object(y["setInterval"])(t.refreshTtl,1e4))}).catch(function(e){404==e.response.status?t.onRemoved(t.share):t.$message.error({message:"<p>"+e.response.status+"-"+e.response.statusText+"</p><p>"+e.response.data+"</p>",dangerouslyUseHTMLString:!0})})},refreshTtl:function(){this.share.ttl-=1e4},deleteShare:function(){var t=this;this.deleteLoading=!0,this.$confirm("确定删除文件共享？",{type:"warning"}).then(function(){v.a.delete("/api/shares/".concat(t.share.id),{headers:{token:t.share.token}}).then(function(){t.onRemoved(t.share)}).finally(function(){t.deleteLoading=!1})}).catch(function(){}).finally(function(){t.deleteLoading=!1})},humanReadableDataSize:function(t){var e;return e=t>1099511627776?(t/1099511627776).toFixed(1)+"TB":t>1073741824?(t/1073741824).toFixed(1)+"GB":t>1048576?(t/1048576).toFixed(1)+"MB":t>1024?(t/1024).toFixed(1)+"KB":t.toFixed(0)+"Bytes",e}}},S=x,b=Object(r["a"])(S,m,g,!1,null,null,null),_=b.exports,w={components:{files:_},data:function(){return{isChooseUpload:!1,share:null,uploadPercentage:0,uploadStatus:null,speed:null,lastLoaded:0,lastLoadTime:null,config:null,ttl:null,uploadedList:null==localStorage.getItem("uploaded")?[]:JSON.parse(localStorage.getItem("uploaded")),fileList:null}},computed:{address:function(){return window.location.href+this.share.id}},created:function(){var t=this,e=this.$loading();v.a.get("/api/config").then(function(e){t.config=e.data;var a=!0,i=!1,s=void 0;try{for(var n,l=t.config.share.ttlOptions[Symbol.iterator]();!(a=(n=l.next()).done);a=!0){var o=n.value;o.defaultOption&&(t.ttl=o.value)}}catch(r){i=!0,s=r}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}t.ttl||(t.ttl=t.config.share.ttlOptions[0].value)}).catch(function(e){t.$message.error({message:"<p>"+e.response.status+"-"+e.response.statusText+"</p><p>"+e.response.data+"</p>",dangerouslyUseHTMLString:!0})}).finally(function(){e.close()})},methods:{submitUpload:function(){var t=this,e=new FormData;e.append("ttl",this.ttl);var a=!0,i=!1,s=void 0;try{for(var n,l=this.fileList[Symbol.iterator]();!(a=(n=l.next()).done);a=!0){var o=n.value;e.append("file",o.raw)}}catch(r){i=!0,s=r}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}v.a.post("/api/shares",e,{onUploadProgress:this.showProgress}).then(function(e){t.handleSuccess(e.data)}).catch(function(e){t.handleError(e)}),this.isChooseUpload=!0},onChange:function(t,e){this.fileList=e},handleSuccess:function(t){this.$message.success("上传成功"),this.isSuccess=!0,this.share=t,this.uploadStatus="success",this.speed=null,this.uploadedList.unshift(this.share),this.save()},handleError:function(t){var e=JSON.parse(t.message);this.$message.error("上传失败。"+e.message),this.uploadStatus="exception"},showProgress:function(t){this.uploadPercentage=parseInt(100*t.loaded/t.total);var e=(new Date).getTime(),a=(e-this.lastLoadTime)/1e3;if(a>1){var i=t.loaded-this.lastLoaded;this.lastLoaded=t.loaded,this.lastLoadTime=e;var s=i/a;this.speed=s>1073741824?(s/1073741824).toFixed(1)+" GB/s":s>1048576?(s/1048576).toFixed(1)+" MB/s":s>1024?(s/1024).toFixed(1)+" KB/s":s.toFixed(0)+" B/s"}},handleRemove:function(){return!1},chooseUpload:function(t){if(this.maxFileSize>0&&t.size>1024*this.maxFileSize*1024)return this.$message.error("文件过大，不能超过"+this.maxFileSize+"MB"),!1;this.isChooseUpload=!0,this.isChooseDownload=!1,this.lastLoadTime=(new Date).getTime()},onCopySuccess:function(){this.$message.success("地址已复制")},backToHome:function(){this.isChooseUpload=!1,this.uploadStatus=null,this.uploadPercentage=0,this.share=null,this.fileList=null},shareRemoved:function(t){for(var e=-1,a=0;a<this.uploadedList.length;a++){var i=this.uploadedList[a];if(i.id==t.id){e=a;break}}e>-1&&(this.uploadedList.splice(e,1),this.save())},save:function(){var t=JSON.parse(JSON.stringify(this.uploadedList)),e=!0,a=!1,i=void 0;try{for(var s,n=t[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){var l=s.value;l.ttl=null}}catch(o){a=!0,i=o}finally{try{e||null==n.return||n.return()}finally{if(a)throw i}}localStorage.setItem("uploaded",JSON.stringify(t))}}},L=w,O=(a("41f3"),Object(r["a"])(L,p,h,!1,null,null,null)),C=O.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticStyle:{width:"400px",height:"400px",display:"inline-block",margin:"10px"}},[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("\n      文件（点击文件名下载）\n    ")]),a("div",{staticStyle:{height:"300px",position:"relative"}},[t.loading?a("div",[a("p",[t._v("正在读取文件...")])]):a("div",[t.response?a("files",{attrs:{share:t.response}}):a("div",[a("p",[t._v(t._s(t.errorMsg))])])],1),a("div",{staticStyle:{position:"absolute",bottom:"0px",width:"100%"}},[a("el-link",{attrs:{type:"primary"},on:{click:t.gotoUpload}},[t._v("使用SendFile共享文件")])],1)])])],1)},z=[],F={components:{files:_},data:function(){return{response:null,loading:!0,errorMsg:null}},methods:{gotoUpload:function(){this.$router.push("/")}},created:function(){var t=this;v.a.get("/api/shares/".concat(this.$route.params.shareId)).then(function(e){t.response=e.data},function(e){t.errorMsg=e.response.data.message}).finally(function(){t.loading=!1})}},T=F,$=Object(r["a"])(T,k,z,!1,null,null,null),j=$.exports;i["default"].use(u["a"]);var P=new u["a"]({routes:[{path:"/",component:C},{path:"/:shareId",component:j}]}),I=a("4eb5"),M=a.n(I),U=a("5c96"),B=a.n(U),D=(a("0fae"),{humanreadableDuration:function(t){var e="";return t>864e5&&(e+=parseInt(t/864e5)+"天",t%=864e5),t>36e5&&(e+=parseInt(t/36e5)+"小时",t%=36e5),t>6e4&&(e+=parseInt(t/6e4)+"分钟"),""==e?e="1分钟内":e+="后",e}});i["default"].config.productionTip=!1,i["default"].use(B.a),i["default"].use(M.a),i["default"].prototype.util=D,new i["default"]({router:P,render:function(t){return t(d)}}).$mount("#app")},"64a9":function(t,e,a){},bd16:function(t,e,a){}});
//# sourceMappingURL=app.1b81ab57.js.map