(function(t){function e(e){for(var s,o,l=e[0],r=e[1],c=e[2],p=0,u=[];p<l.length;p++)o=l[p],i[o]&&u.push(i[o][0]),i[o]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);d&&d(e);while(u.length)u.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],s=!0,l=1;l<a.length;l++){var r=a[l];0!==i[r]&&(s=!1)}s&&(n.splice(e--,1),t=o(o.s=a[0]))}return t}var s={},i={app:0},n=[];function o(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=s,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(a,s,function(e){return t[e]}.bind(null,s));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/ui/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var d=r;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var s=a("64a9"),i=a.n(s);i.a},"41f3":function(t,e,a){"use strict";var s=a("bd16"),i=a.n(s);i.a},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("el-row",{staticStyle:{"line-height":"100px"}},[a("i",{staticClass:"el-icon-s-promotion",staticStyle:{"margin-right":"20px","font-size":"60px",color:"#409EFF","vertical-align":"middle"}}),a("span",{staticStyle:{"font-size":"40px","font-weight":"bold",color:"#606266","vertical-align":"middle"}},[t._v("Send File")])]),a("router-view")],1)},n=[],o={name:"app"},l=o,r=(a("034f"),a("2877")),c=Object(r["a"])(l,i,n,!1,null,null,null),d=c.exports,p=a("8c4f"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"mycard",staticStyle:{width:"400px"}},[t.config?t.isChooseUpload?a("div",[a("el-progress",{staticStyle:{"margin-top":"20px"},attrs:{type:"circle","stroke-width":18,percentage:t.uploadPercentage,status:t.uploadStatus}}),a("div",{staticStyle:{height:"20px","line-height":"20px"}},[a("span",{staticStyle:{"font-size":"small"}},[t._v(t._s(t.speed))])]),t.share?a("div",{staticStyle:{"text-align":"left",position:"relative",height:"280px"}},[t.config?a("span",{staticStyle:{"font-size":"small"}},[t._v("文件"),t.share.ttl?a("span",[t._v("将于 "+t._s(this.util.humanreadableDuration(t.share.ttl))+" ")]):a("span",[t._v("永不")]),t._v("过期")]):t._e(),a("div",{staticStyle:{margin:"20px 5px"}},[a("el-row",[t._v("下载链接：")]),a("el-input",{attrs:{value:t.address}},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.address,expression:"address",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopySuccess,expression:"onCopySuccess",arg:"success"}],attrs:{slot:"append",type:"primary",size:"mini"},slot:"append"},[t._v("复制链接")])],1),a("el-row",{staticStyle:{"font-size":"small"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px"}}),t._v("复制链接地址，粘贴到浏览器地址栏中，并打开页面")])],1),a("div",{staticStyle:{position:"absolute",bottom:"0px","text-align":"center",width:"100%"}},[a("el-link",{attrs:{type:"primary",icon:"el-icon-s-home"},on:{click:t.backToHome}},[t._v("再次上传")])],1)]):a("div",{staticStyle:{margin:"50px 5px"}},[a("span",[t._v("正在上传，成功后生成下载链接。。。")])])],1):a("div",{staticStyle:{"text-align":"left"}},[a("el-upload",{staticStyle:{"text-align":"left","min-height":"310px"},attrs:{drag:"",action:"","show-file-list":!0,"auto-upload":!1,multiple:!0,"on-change":t.onChange}},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{"font-size":"67px",color:"#C0C4CC",margin:"40px 0 16px","line-height":"50px"}}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击添加文件")])]),t.config?a("div",{staticClass:"el-upload__tip",staticStyle:{"text-align":"center"},attrs:{slot:"tip"},slot:"tip"},[t._v("可上传"),t.config.share.maxFileSize>0?a("span",[t._v(t._s(this.config.share.maxFileSize)+"MB")]):a("span",[t._v("任意大小")]),t._v("的文件")]):t._e()]),a("el-row",{staticStyle:{"margin-top":"5px","line-height":"42px"}},[t.config?a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择"},model:{value:t.ttl,callback:function(e){t.ttl=e},expression:"ttl"}},t._l(t.config.share.ttlOptions,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.value}})}),1):t._e(),a("span",{staticStyle:{"margin-left":"10px",color:"#606266"}},[t._v("后过期")])],1),a("el-row",{staticStyle:{"margin-top":"5px","line-height":"42px"}},[a("el-checkbox",{model:{value:t.passwordEnabled,callback:function(e){t.passwordEnabled=e},expression:"passwordEnabled"}},[t._v("密码保护")]),t.passwordEnabled?a("el-input",{staticStyle:{width:"200px","margin-left":"10px"},attrs:{autofocus:"",type:t.showPassword?"text":"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[a("i",{class:"el-input__icon iconfont "+(t.showPassword?"icon-eye-open":"icon-eye-close"),staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function(e){t.showPassword=!t.showPassword}},slot:"suffix"})]):t._e()],1),a("el-button",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{type:"primary",icon:"el-icon-upload",disabled:null===t.fileList||0==t.fileList.length},on:{click:t.submitUpload}},[t._v("上传")])],1):a("div",{staticStyle:{"min-height":"300px",width:"100%",display:"table","text-align":"center"}},[a("p",{staticStyle:{display:"table-cell","vertical-align":"middle",color:"#F56C6C","font-size":"large"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px"}}),t._v(t._s(t.errorMsg))])])]),a("transition",[t.uploadedList.length>0?a("el-card",{staticClass:"mycard",staticStyle:{width:"502px"}},[a("transition-group",{attrs:{name:"list"}},t._l(t.uploadedList,function(e){return a("el-card",{key:e.id,staticStyle:{margin:"10px 0px"}},[a("files",{attrs:{share:e,"on-removed":t.shareRemoved}})],1)}),1)],1):t._e()],1)],1)},h=[],f=(a("6b54"),a("ac4d"),a("8a81"),a("ac6a"),a("bc3a")),g=a.n(f),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._l(t.share.files,function(e,s){return a("el-row",{key:s},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-tooltip",{attrs:{content:e.name,placement:"top"}},[a("el-link",{staticStyle:{"vertical-align":"middle","font-size":"large",margin:"0px"},attrs:{href:"/api/shares/"+t.share.id+"/"+e.name,icon:"el-icon-document"}},[a("div",{staticStyle:{"max-width":"340px","text-align":"left",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[t._v(t._s(e.name))])])],1)],1),a("div",{staticStyle:{display:"inline-block",float:"right"}},[a("span",{staticStyle:{"vertical-align":"middle","font-size":"small"}},[t._v(t._s(t.humanReadableDataSize(e.size)))])])])}),a("div",{staticClass:"el-divider el-divider--horizontal",staticStyle:{margin:"10px 0px"}}),a("el-row",[a("div",{staticStyle:{display:"inline-block",float:"left","text-align":"left"}},[a("el-row",[a("span",{staticStyle:{"vertical-align":"middle","font-size":"small"}},[t._v("文件"),t.share.ttl?a("span",[t._v("将于 "+t._s(this.util.humanreadableDuration(t.share.ttl))+" ")]):a("span",[t._v("永不")]),t._v("过期")])])],1),a("div",{staticStyle:{display:"inline-block",float:"right"}},[a("el-tooltip",{attrs:{content:"复制链接",placement:"top"}},[a("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.address,expression:"address",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopySuccess,expression:"onCopySuccess",arg:"success"}],attrs:{size:"mini",icon:"el-icon-document-copy"}})],1),t.share.token?a("el-tooltip",{attrs:{content:"删除文件",placement:"top"}},[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",loading:t.deleteLoading},on:{click:t.deleteShare}})],1):t._e()],1)])],2)},m=[],y=a("5118"),w={props:{share:{type:Object},onRemoved:{type:Function,required:!0}},data:function(){return{address:window.location.href+("/"==this.$route.path?this.share.id:""),syncSharePolling:null,countdown:null,deleteLoading:!1}},created:function(){this.syncShare(),this.syncSharePolling=Object(y["setInterval"])(this.syncShare,12e4)},destroyed:function(){Object(y["clearInterval"])(this.syncSharePolling)},methods:{onCopySuccess:function(){this.$message.success("地址已复制")},syncShare:function(){var t=this;this.countdown&&Object(y["clearInterval"])(this.countdown),g.a.get("/api/shares/".concat(this.share.id),{headers:{token:this.share.token,password:this.share.password}}).then(function(e){t.share.ttl=e.data.ttl,t.share.files=e.data.files,t.share.ttl&&(t.countdown=Object(y["setInterval"])(t.refreshTtl,1e4))}).catch(function(e){404==e.response.data.status?t.onRemoved(t.share):t.$message.error(e.response.data.message?e.response.data.message:e.toString())})},refreshTtl:function(){this.share.ttl-=1e4},deleteShare:function(){var t=this;this.deleteLoading=!0,this.$confirm("确定删除文件共享？",{type:"warning"}).then(function(){g.a.delete("/api/shares/".concat(t.share.id),{headers:{token:t.share.token}}).then(function(){t.onRemoved(t.share)}).catch(function(e){t.$message.error(e.response.data.message?e.response.data.message:e.toString())}).finally(function(){t.deleteLoading=!1})}).catch(function(){t.deleteLoading=!1})},humanReadableDataSize:function(t){var e;return e=t>1099511627776?(t/1099511627776).toFixed(1)+"TB":t>1073741824?(t/1073741824).toFixed(1)+"GB":t>1048576?(t/1048576).toFixed(1)+"MB":t>1024?(t/1024).toFixed(1)+"KB":t.toFixed(0)+"Bytes",e}}},x=w,S=Object(r["a"])(x,v,m,!1,null,null,null),b=S.exports,_={components:{files:b},data:function(){return{isChooseUpload:!1,share:null,uploadPercentage:0,uploadStatus:null,speed:null,lastLoaded:0,lastLoadTime:null,config:null,ttl:null,uploadedList:null==localStorage.getItem("uploaded")?[]:JSON.parse(localStorage.getItem("uploaded")),fileList:null,passwordEnabled:!1,password:null,showPassword:!1,errorMsg:null}},computed:{address:function(){return window.location.href+this.share.id}},created:function(){var t=this,e=this.$loading();g.a.get("/api/config").then(function(e){t.config=e.data;var a=!0,s=!1,i=void 0;try{for(var n,o=t.config.share.ttlOptions[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value;l.defaultOption&&(t.ttl=l.value)}}catch(r){s=!0,i=r}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}t.ttl||(t.ttl=t.config.share.ttlOptions[0].value)}).catch(function(e){t.errorMsg=e.response.data.message?e.response.data.message:e.toString()}).finally(function(){e.close()})},methods:{submitUpload:function(){var t=this,e=new FormData;e.append("ttl",this.ttl),this.passwordEnabled&&this.password&&e.append("password",this.password);var a=!0,s=!1,i=void 0;try{for(var n,o=this.fileList[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value;e.append("file",l.raw)}}catch(r){s=!0,i=r}finally{try{a||null==o.return||o.return()}finally{if(s)throw i}}g.a.post("/api/shares",e,{onUploadProgress:this.showProgress}).then(function(e){t.handleSuccess(e.data)}).catch(function(e){t.handleError(e)}),this.isChooseUpload=!0},onChange:function(t,e){this.fileList=e},handleSuccess:function(t){this.$message.success("上传成功"),this.isSuccess=!0,this.share=t,this.uploadStatus="success",this.speed=null,this.uploadedList.unshift(this.share),this.save()},handleError:function(t){this.$message.error("上传失败。"+t),this.uploadStatus="exception"},showProgress:function(t){this.uploadPercentage=parseInt(100*t.loaded/t.total);var e=(new Date).getTime(),a=(e-this.lastLoadTime)/1e3;if(a>1){var s=t.loaded-this.lastLoaded;this.lastLoaded=t.loaded,this.lastLoadTime=e;var i=s/a;this.speed=i>1073741824?(i/1073741824).toFixed(1)+" GB/s":i>1048576?(i/1048576).toFixed(1)+" MB/s":i>1024?(i/1024).toFixed(1)+" KB/s":i.toFixed(0)+" B/s"}},handleRemove:function(){return!1},chooseUpload:function(t){if(this.maxFileSize>0&&t.size>1024*this.maxFileSize*1024)return this.$message.error("文件过大，不能超过"+this.maxFileSize+"MB"),!1;this.isChooseUpload=!0,this.isChooseDownload=!1,this.lastLoadTime=(new Date).getTime()},onCopySuccess:function(){this.$message.success("地址已复制")},backToHome:function(){this.isChooseUpload=!1,this.uploadStatus=null,this.uploadPercentage=0,this.share=null,this.fileList=null,this.passwordEnabled=!1,this.password=null},shareRemoved:function(t){for(var e=-1,a=0;a<this.uploadedList.length;a++){var s=this.uploadedList[a];if(s.id==t.id){e=a;break}}e>-1&&(this.uploadedList.splice(e,1),this.save())},save:function(){var t=JSON.parse(JSON.stringify(this.uploadedList)),e=!0,a=!1,s=void 0;try{for(var i,n=t[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){var o=i.value;o.ttl=null}}catch(l){a=!0,s=l}finally{try{e||null==n.return||n.return()}finally{if(a)throw s}}localStorage.setItem("uploaded",JSON.stringify(t))}}},k=_,P=(a("41f3"),Object(r["a"])(k,u,h,!1,null,null,null)),C=P.exports,z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticStyle:{width:"560px","min-height":"400px",display:"inline-block",margin:"10px"}},[a("div",{staticStyle:{"min-height":"344px"}},[t.share?a("div",{staticStyle:{"min-height":"310px"}},[a("span",[t._v("文件（点击文件名下载）")]),a("el-divider"),a("files",{staticStyle:{margin:"0px 50px 0px 50px"},attrs:{share:t.share,"on-removed":t.shareRemoved}})],1):t.needPassword?a("div",{staticStyle:{"min-height":"310px"}},[a("el-row",{staticStyle:{height:"70px"}}),a("el-row",[a("span",[t._v("文件已加密，请输入密码")])]),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-input",{staticStyle:{width:"300px","margin-right":"10px"},attrs:{autofocus:"",type:t.showPassword?"text":"password"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.authorize(e)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[a("i",{class:"el-input__icon iconfont "+(t.showPassword?"icon-eye-open":"icon-eye-close"),staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function(e){t.showPassword=!t.showPassword}},slot:"suffix"})]),a("el-button",{attrs:{type:"primary"},on:{click:t.authorize}},[t._v("解锁")])],1)],1):a("div",{staticStyle:{"min-height":"310px",width:"100%",display:"table","text-align":"center"}},[a("p",{staticStyle:{"font-size":"large","vertical-align":"middle",display:"table-cell"}},[t._v(t._s(t.errorMsg))])]),a("div",{staticStyle:{"margin-top":"20px",width:"100%"}},[a("el-link",{attrs:{type:"primary"},on:{click:t.gotoUpload}},[t._v("使用SendFile共享文件")])],1)])])],1)},O=[],L={components:{files:b},data:function(){return{share:null,errorMsg:null,needPassword:!1,password:null,showPassword:!1}},created:function(){this.getShare()},methods:{gotoUpload:function(){this.$router.push("/")},authorize:function(){var t=this;g.a.post("/api/shares/".concat(this.$route.params.shareId,"/authorize"),{password:this.password}).then(function(){t.getShare()}).catch(function(e){401==e.response.data.status?t.$message.error("密码错误"):t.$message.error(e.response.data.message?e.response.data.message:e)})},getShare:function(){var t=this,e=this.$loading();g.a.get("/api/shares/".concat(this.$route.params.shareId),{}).then(function(e){t.share=e.data,t.needPassword=!1}).catch(function(e){401==e.response.data.status?t.needPassword=!0:t.errorMsg=e.response.data.message?e.response.data.message:e}).finally(function(){e.close()})},shareRemoved:function(){this.errorMsg="文件已过期",this.needPassword=!1,this.share=null}}},F=L,$=Object(r["a"])(F,z,O,!1,null,null,null),j=$.exports;s["default"].use(p["a"]);var E=new p["a"]({routes:[{path:"/",component:C},{path:"/:shareId",component:j}]}),M=a("4eb5"),I=a.n(M),T=a("5c96"),B=a.n(T),U=(a("0fae"),{humanreadableDuration:function(t){var e="";return t>864e5&&(e+=parseInt(t/864e5)+"天",t%=864e5),t>36e5&&(e+=parseInt(t/36e5)+"小时",t%=36e5),t>6e4&&(e+=parseInt(t/6e4)+"分钟"),""==e?e="1分钟内":e+="后",e}});a("ed2c");s["default"].config.productionTip=!1,s["default"].use(B.a),s["default"].use(I.a),s["default"].prototype.util=U,new s["default"]({router:E,render:function(t){return t(d)}}).$mount("#app")},"64a9":function(t,e,a){},bd16:function(t,e,a){},ed2c:function(t,e,a){}});
//# sourceMappingURL=app.04bad96a.js.map